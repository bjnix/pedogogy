<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
		"http://www.w3.org/TR/html4/DTD/strict.dtd">
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="shortcut icon" href="/bitmaps/favicon.png">
	<link rel="icon" href="/bitmaps/favicon.png" type="image/png">
	<link href="../faq.css" rel="Stylesheet" type="text/css">

	<title>Winsock Programmer&rsquo;s FAQ: Get MAC Address, SNMP Method</title>

	<style type="text/css">
		#next-link {
			width: 38px;
			height: 32px;
			text-decoration: none;
			display: block;
			background-image: url(../bitmaps/navbar-icons.png);
			background-position: -38px 0;
		}
		#prev-link {
			width: 38px;
			height: 32px;
			text-decoration: none;
			display: block;
			background-image: url(../bitmaps/navbar-icons.png);
			background-position: 0 0;
		}
		#stop-link {
			width: 38px;
			height: 32px;
			text-decoration: none;
			display: block;
			background-image: url(../bitmaps/navbar-icons.png);
			background-position: -76px 0;
		}
		.navbar {
			border: 8px solid #d0d0a0;
			border-spacing: 0;
			border-radius: 10px;
			-moz-border-radius: 10px;
			-webkit-border-radius: 10px;
			height: 140px;
			margin: auto;   /* center on page */
			margin-top: 10px;
			text-align: center;
			width: 95%;
		}
		.navbar td {
			background-color: #006000;
			border: 10px solid #e0e0c0;
			color: #ffffee;
			font-size: 182%;
			font-family:
				"verdana",
				"luxi sans",
				"helvetica narrow",
				"arial condensed",
				"arial",
				"univers",
				sans-serif;
			font-weight: bold;
			text-align: center;
		}
		.navbarcap {
			background-color: #e0e0c0 !important;
			cursor: pointer;
			padding-left: 10px;
			width: 50px;
		}
	</style>
</head>

<body>








	




	

	<!--  **** Navigation Bar ****  -->
	<table class="navbar">
		<tr>
			<td class="navbarcap" onclick="location.href='../examples/getmac-rpc.html'">
				<a id="prev-link" href="../examples/getmac-rpc.html"></a>
			</td>

			<td>
				Winsock Programmer&rsquo;s FAQ<br>

				

				
				
				
					Examples: Get MAC Address, SNMP Method
				
			</td>

			<td class="navbarcap" onclick="location.href='../examples/username.html'">
				<a id="next-link" href="../examples/username.html"></a>
			</td>
		</tr>
	</table>

	<!--  **** Body Container ****  -->
	<div id="body" style="padding-left: 30px" >


<p>James Marsh (<tt>James.Marsh at sandtechnology dot com</tt>) writes:</p>

<i>
	<p class=inset>In my search for an ironclad method
	of finding the MAC address of the ethernet card of a
	system, I attempted the NetBIOS method as described in
	the FAQ, but found this to be unacceptable as some of
	our customers reportedly didn&rsquo;t use [NetBIOS]. I
	passed over the RPC method, and found a solution in a <a
	href="http://members.tripod.com/~staskh/">page</a> maintained
	by Stas Khirman and Raz Galili.... They describe a method
	of using the internal SNMP calls in Windows (NT, 95, and
	2000 have worked for me) that are used by netstat and other
	windows utilities, but unfortunately provide no code example
	for finding the MAC code.</p>

	<p class=inset>[Below is] a small program I&rsquo;ve written
	up, so that hopefully other people won&rsquo;t have to go
	through the same learning curve I did with SNMP. I will also
	attach a file, snmpapi.cpp, that was written by Stas Khirman
	and distributed on his web page.</p>
</i>






	


<hr class="noshade">

<h4 class=lmargin><a href="src/snmpmac.cpp">snmpmac.cpp</a></h4>

<pre>
<font color="0000ff"><strong>#include <font color="#008000">&lt;snmp.h&gt;</font></strong></font>
<font color="0000ff"><strong>#include <font color="#008000">&lt;conio.h&gt;</font></strong></font>
<font color="0000ff"><strong>#include <font color="#008000">&lt;stdio.h&gt;</font></strong></font>

<strong>typedef</strong> <font color="#2040a0">BOOL</font><font color="4444FF">(</font><font color="#2040a0">WINAPI</font> <font color="4444FF">*</font> <font color="#2040a0">pSnmpExtensionInit</font><font color="4444FF">)</font> <font color="4444FF">(</font>
        <font color="#2040a0">IN</font> <font color="#2040a0">DWORD</font> <font color="#2040a0">dwTimeZeroReference</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">HANDLE</font> <font color="4444FF">*</font> <font color="#2040a0">hPollForTrapEvent</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font> <font color="#2040a0">supportedView</font><font color="4444FF">)</font><font color="4444FF">;</font>

<strong>typedef</strong> <font color="#2040a0">BOOL</font><font color="4444FF">(</font><font color="#2040a0">WINAPI</font> <font color="4444FF">*</font> <font color="#2040a0">pSnmpExtensionTrap</font><font color="4444FF">)</font> <font color="4444FF">(</font>
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font> <font color="#2040a0">enterprise</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnInteger</font> <font color="4444FF">*</font> <font color="#2040a0">genericTrap</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnInteger</font> <font color="4444FF">*</font> <font color="#2040a0">specificTrap</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnTimeticks</font> <font color="4444FF">*</font> <font color="#2040a0">timeStamp</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">RFC1157VarBindList</font> <font color="4444FF">*</font> <font color="#2040a0">variableBindings</font><font color="4444FF">)</font><font color="4444FF">;</font>

<strong>typedef</strong> <font color="#2040a0">BOOL</font><font color="4444FF">(</font><font color="#2040a0">WINAPI</font> <font color="4444FF">*</font> <font color="#2040a0">pSnmpExtensionQuery</font><font color="4444FF">)</font> <font color="4444FF">(</font>
        <font color="#2040a0">IN</font> <font color="#2040a0">BYTE</font> <font color="#2040a0">requestType</font>,
        <font color="#2040a0">IN</font> <font color="#2040a0">OUT</font> <font color="#2040a0">RFC1157VarBindList</font> <font color="4444FF">*</font> <font color="#2040a0">variableBindings</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnInteger</font> <font color="4444FF">*</font> <font color="#2040a0">errorStatus</font>,
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnInteger</font> <font color="4444FF">*</font> <font color="#2040a0">errorIndex</font><font color="4444FF">)</font><font color="4444FF">;</font>

<strong>typedef</strong> <font color="#2040a0">BOOL</font><font color="4444FF">(</font><font color="#2040a0">WINAPI</font> <font color="4444FF">*</font> <font color="#2040a0">pSnmpExtensionInitEx</font><font color="4444FF">)</font> <font color="4444FF">(</font>
        <font color="#2040a0">OUT</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font> <font color="#2040a0">supportedView</font><font color="4444FF">)</font><font color="4444FF">;</font>
    
<strong>void</strong> <font color="#2040a0">main</font><font color="4444FF">(</font><font color="4444FF">)</font>
<font color="4444FF"><strong>{</strong></font>
    <font color="#2040a0">WSADATA</font> <font color="#2040a0">WinsockData</font><font color="4444FF">;</font>
    <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">WSAStartup</font><font color="4444FF">(</font><font color="#2040a0">MAKEWORD</font><font color="4444FF">(</font><font color="#FF0000">2</font>, <font color="#FF0000">0</font><font color="4444FF">)</font>, <font color="4444FF">&amp;</font><font color="#2040a0">WinsockData</font><font color="4444FF">)</font> <font color="4444FF">!</font><font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#2040a0">fprintf</font><font color="4444FF">(</font><font color="#2040a0">stderr</font>, <font color="#008000">&quot;This program requires Winsock 2.x!<font color="#77dd77">\n</font>&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
        <strong>return</strong><font color="4444FF">;</font>
    <font color="4444FF"><strong>}</strong></font>

    <font color="#2040a0">HINSTANCE</font> <font color="#2040a0">m_hInst</font><font color="4444FF">;</font>
    <font color="#2040a0">pSnmpExtensionInit</font> <font color="#2040a0">m_Init</font><font color="4444FF">;</font>
    <font color="#2040a0">pSnmpExtensionInitEx</font> <font color="#2040a0">m_InitEx</font><font color="4444FF">;</font>
    <font color="#2040a0">pSnmpExtensionQuery</font> <font color="#2040a0">m_Query</font><font color="4444FF">;</font>
    <font color="#2040a0">pSnmpExtensionTrap</font> <font color="#2040a0">m_Trap</font><font color="4444FF">;</font>
    <font color="#2040a0">HANDLE</font> <font color="#2040a0">PollForTrapEvent</font><font color="4444FF">;</font>
    <font color="#2040a0">AsnObjectIdentifier</font> <font color="#2040a0">SupportedView</font><font color="4444FF">;</font>
    <font color="#2040a0">UINT</font> <font color="#2040a0">OID_ifEntryType</font><font color="4444FF">[</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#FF0000">1</font>, <font color="#FF0000">3</font>, <font color="#FF0000">6</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>, <font color="#FF0000">3</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <font color="#2040a0">UINT</font> <font color="#2040a0">OID_ifEntryNum</font><font color="4444FF">[</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#FF0000">1</font>, <font color="#FF0000">3</font>, <font color="#FF0000">6</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <font color="#2040a0">UINT</font> <font color="#2040a0">OID_ipMACEntAddr</font><font color="4444FF">[</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#FF0000">1</font>, <font color="#FF0000">3</font>, <font color="#FF0000">6</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>, <font color="#FF0000">2</font>, <font color="#FF0000">2</font>, <font color="#FF0000">1</font>, <font color="#FF0000">6</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>                          <font color="#444444">//, 1 ,6 };</font>
    <font color="#2040a0">AsnObjectIdentifier</font> <font color="#2040a0">MIB_ifMACEntAddr</font> <font color="4444FF">=</font>
        <font color="4444FF"><strong>{</strong></font> <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">OID_ipMACEntAddr</font><font color="4444FF">)</font> / <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">UINT</font><font color="4444FF">)</font>, <font color="#2040a0">OID_ipMACEntAddr</font> <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <font color="#2040a0">AsnObjectIdentifier</font> <font color="#2040a0">MIB_ifEntryType</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">OID_ifEntryType</font><font color="4444FF">)</font> / <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">UINT</font><font color="4444FF">)</font>, <font color="#2040a0">OID_ifEntryType</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <font color="#2040a0">AsnObjectIdentifier</font> <font color="#2040a0">MIB_ifEntryNum</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">OID_ifEntryNum</font><font color="4444FF">)</font> / <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">UINT</font><font color="4444FF">)</font>, <font color="#2040a0">OID_ifEntryNum</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <font color="#2040a0">RFC1157VarBindList</font> <font color="#2040a0">varBindList</font><font color="4444FF">;</font>
    <font color="#2040a0">RFC1157VarBind</font> <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">;</font>
    <font color="#2040a0">AsnInteger</font> <font color="#2040a0">errorStatus</font><font color="4444FF">;</font>
    <font color="#2040a0">AsnInteger</font> <font color="#2040a0">errorIndex</font><font color="4444FF">;</font>
    <font color="#2040a0">AsnObjectIdentifier</font> <font color="#2040a0">MIB_NULL</font> <font color="4444FF">=</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#FF0000">0</font>, <font color="#FF0000">0</font>
    <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
    <strong>int</strong> <font color="#2040a0">ret</font><font color="4444FF">;</font>
    <strong>int</strong> <font color="#2040a0">dtmp</font><font color="4444FF">;</font>
    <strong>int</strong> <font color="#2040a0">i</font> <font color="4444FF">=</font> <font color="#FF0000">0</font>, <font color="#2040a0">j</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
    <font color="#2040a0">BOOL</font> <font color="#2040a0">found</font> <font color="4444FF">=</font> <font color="#2040a0">FALSE</font><font color="4444FF">;</font>
    <strong>char</strong> <font color="#2040a0">TempEthernet</font><font color="4444FF">[</font><font color="#FF0000">13</font><font color="4444FF">]</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Init</font> <font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">;</font>
    <font color="#2040a0">m_InitEx</font> <font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Query</font> <font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Trap</font> <font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">;</font>

    <font color="#444444">/* Load the SNMP dll and get the addresses of the functions
       necessary */</font>
    <font color="#2040a0">m_hInst</font> <font color="4444FF">=</font> <font color="#2040a0">LoadLibrary</font><font color="4444FF">(</font><font color="#008000">&quot;inetmib1.dll&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">m_hInst</font> <font color="4444FF">&lt;</font> <font color="4444FF">(</font><font color="#2040a0">HINSTANCE</font><font color="4444FF">)</font> <font color="#2040a0">HINSTANCE_ERROR</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
        <font color="#2040a0">m_hInst</font> <font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">;</font>
        <strong>return</strong><font color="4444FF">;</font>
    <font color="4444FF"><strong>}</strong></font>
    <font color="#2040a0">m_Init</font> <font color="4444FF">=</font>
        <font color="4444FF">(</font><font color="#2040a0">pSnmpExtensionInit</font><font color="4444FF">)</font> <font color="#2040a0">GetProcAddress</font><font color="4444FF">(</font><font color="#2040a0">m_hInst</font>, <font color="#008000">&quot;SnmpExtensionInit&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">m_InitEx</font> <font color="4444FF">=</font>
        <font color="4444FF">(</font><font color="#2040a0">pSnmpExtensionInitEx</font><font color="4444FF">)</font> <font color="#2040a0">GetProcAddress</font><font color="4444FF">(</font><font color="#2040a0">m_hInst</font>,
                                              <font color="#008000">&quot;SnmpExtensionInitEx&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Query</font> <font color="4444FF">=</font>
        <font color="4444FF">(</font><font color="#2040a0">pSnmpExtensionQuery</font><font color="4444FF">)</font> <font color="#2040a0">GetProcAddress</font><font color="4444FF">(</font><font color="#2040a0">m_hInst</font>,
                                             <font color="#008000">&quot;SnmpExtensionQuery&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Trap</font> <font color="4444FF">=</font>
        <font color="4444FF">(</font><font color="#2040a0">pSnmpExtensionTrap</font><font color="4444FF">)</font> <font color="#2040a0">GetProcAddress</font><font color="4444FF">(</font><font color="#2040a0">m_hInst</font>, <font color="#008000">&quot;SnmpExtensionTrap&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">m_Init</font><font color="4444FF">(</font><font color="#2040a0">GetTickCount</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="4444FF">&amp;</font><font color="#2040a0">PollForTrapEvent</font>, <font color="4444FF">&amp;</font><font color="#2040a0">SupportedView</font><font color="4444FF">)</font><font color="4444FF">;</font>

    <font color="#444444">/* Initialize the variable list to be retrieved by m_Query */</font>
    <font color="#2040a0">varBindList</font>.<font color="#2040a0">list</font> <font color="4444FF">=</font> <font color="#2040a0">varBind</font><font color="4444FF">;</font>
    <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">name</font> <font color="4444FF">=</font> <font color="#2040a0">MIB_NULL</font><font color="4444FF">;</font>
    <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">name</font> <font color="4444FF">=</font> <font color="#2040a0">MIB_NULL</font><font color="4444FF">;</font>

    <font color="#444444">/* Copy in the OID to find the number of entries in the
       Inteface table */</font>
    <font color="#2040a0">varBindList</font>.<font color="#2040a0">len</font> <font color="4444FF">=</font> <font color="#FF0000">1</font><font color="4444FF">;</font>        <font color="#444444">/* Only retrieving one item */</font>
    <font color="#2040a0">SNMP_oidcpy</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">name</font>, <font color="4444FF">&amp;</font><font color="#2040a0">MIB_ifEntryNum</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">ret</font> <font color="4444FF">=</font>
        <font color="#2040a0">m_Query</font><font color="4444FF">(</font><font color="#2040a0">ASN_RFC1157_GETNEXTREQUEST</font>, <font color="4444FF">&amp;</font><font color="#2040a0">varBindList</font>, <font color="4444FF">&amp;</font><font color="#2040a0">errorStatus</font>,
                <font color="4444FF">&amp;</font><font color="#2040a0">errorIndex</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;# of adapters in this system : %i<font color="#77dd77">\n</font>&quot;</font>,
           <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">number</font><font color="4444FF">)</font><font color="4444FF">;</font> <font color="#2040a0">varBindList</font>.<font color="#2040a0">len</font> <font color="4444FF">=</font> <font color="#FF0000">2</font><font color="4444FF">;</font>

    <font color="#444444">/* Copy in the OID of ifType, the type of interface */</font>
    <font color="#2040a0">SNMP_oidcpy</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">name</font>, <font color="4444FF">&amp;</font><font color="#2040a0">MIB_ifEntryType</font><font color="4444FF">)</font><font color="4444FF">;</font>

    <font color="#444444">/* Copy in the OID of ifPhysAddress, the address */</font>
    <font color="#2040a0">SNMP_oidcpy</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">name</font>, <font color="4444FF">&amp;</font><font color="#2040a0">MIB_ifMACEntAddr</font><font color="4444FF">)</font><font color="4444FF">;</font>

    <strong>do</strong> <font color="4444FF"><strong>{</strong></font>

        <font color="#444444">/* Submit the query.  Responses will be loaded into varBindList.
           We can expect this call to succeed a # of times corresponding
           to the # of adapters reported to be in the system */</font>
        <font color="#2040a0">ret</font> <font color="4444FF">=</font>
            <font color="#2040a0">m_Query</font><font color="4444FF">(</font><font color="#2040a0">ASN_RFC1157_GETNEXTREQUEST</font>, <font color="4444FF">&amp;</font><font color="#2040a0">varBindList</font>, <font color="4444FF">&amp;</font><font color="#2040a0">errorStatus</font>,
                    <font color="4444FF">&amp;</font><font color="#2040a0">errorIndex</font><font color="4444FF">)</font><font color="4444FF">;</font> <strong>if</strong> <font color="4444FF">(</font><font color="4444FF">!</font><font color="#2040a0">ret</font><font color="4444FF">)</font> <font color="#2040a0">ret</font> <font color="4444FF">=</font> <font color="#FF0000">1</font><font color="4444FF">;</font>

        <strong>else</strong>
            <font color="#444444">/* Confirm that the proper type has been returned */</font>
            <font color="#2040a0">ret</font> <font color="4444FF">=</font>
                <font color="#2040a0">SNMP_oidncmp</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">name</font>, <font color="4444FF">&amp;</font><font color="#2040a0">MIB_ifEntryType</font>,
                             <font color="#2040a0">MIB_ifEntryType</font>.<font color="#2040a0">idLength</font><font color="4444FF">)</font><font color="4444FF">;</font> <strong>if</strong> <font color="4444FF">(</font><font color="4444FF">!</font><font color="#2040a0">ret</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
            <font color="#2040a0">j</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">;</font>
            <font color="#2040a0">dtmp</font> <font color="4444FF">=</font> <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">number</font><font color="4444FF">;</font>
            <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;Interface #%i type : %i<font color="#77dd77">\n</font>&quot;</font>, <font color="#2040a0">j</font>, <font color="#2040a0">dtmp</font><font color="4444FF">)</font><font color="4444FF">;</font>

            <font color="#444444">/* Type 6 describes ethernet interfaces */</font>
            <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">dtmp</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="#FF0000">6</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>

                <font color="#444444">/* Confirm that we have an address here */</font>
                <font color="#2040a0">ret</font> <font color="4444FF">=</font>
                    <font color="#2040a0">SNMP_oidncmp</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">name</font>, <font color="4444FF">&amp;</font><font color="#2040a0">MIB_ifMACEntAddr</font>,
                                 <font color="#2040a0">MIB_ifMACEntAddr</font>.<font color="#2040a0">idLength</font><font color="4444FF">)</font><font color="4444FF">;</font>
                <strong>if</strong> <font color="4444FF">(</font><font color="4444FF">(</font><font color="4444FF">!</font><font color="#2040a0">ret</font><font color="4444FF">)</font>
                    <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font> <font color="4444FF">!</font><font color="4444FF">=</font> <font color="#2040a0">NULL</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
                    <strong>if</strong> <font color="4444FF">(</font>
                        <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                         <font color="#FF0000">0x44</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x45</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x53</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x54</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">4</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>

                        <font color="#444444">/* Ignore all dial-up networking adapters */</font>
                        <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;Interface #%i is a DUN adapter<font color="#77dd77">\n</font>&quot;</font>, <font color="#2040a0">j</font><font color="4444FF">)</font><font color="4444FF">;</font>
                        <strong>continue</strong><font color="4444FF">;</font>
                    <font color="4444FF"><strong>}</strong></font>
                    <strong>if</strong> <font color="4444FF">(</font>
                        <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                         <font color="#FF0000">0x00</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">4</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font>
                        <font color="4444FF">&amp;</font><font color="4444FF">&amp;</font> <font color="4444FF">(</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">5</font><font color="4444FF">]</font> <font color="4444FF">=</font><font color="4444FF">=</font>
                            <font color="#FF0000">0x00</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>

                        <font color="#444444">/* Ignore NULL addresses returned by other network
                           interfaces */</font>
                        <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;Interface #%i is a NULL address<font color="#77dd77">\n</font>&quot;</font>, <font color="#2040a0">j</font><font color="4444FF">)</font><font color="4444FF">;</font>
                        <strong>continue</strong><font color="4444FF">;</font>
                    <font color="4444FF"><strong>}</strong></font>
                    <font color="#2040a0">sprintf</font><font color="4444FF">(</font><font color="#2040a0">TempEthernet</font>, <font color="#008000">&quot;%02x%02x%02x%02x%02x%02x&quot;</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">4</font><font color="4444FF">]</font>,
                            <font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font>.<font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">address</font>.<font color="#2040a0">stream</font><font color="4444FF">[</font><font color="#FF0000">5</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF">;</font>
                    <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;MAC Address of interface #%i: %s<font color="#77dd77">\n</font>&quot;</font>, <font color="#2040a0">j</font>,
                           <font color="#2040a0">TempEthernet</font><font color="4444FF">)</font><font color="4444FF">;</font><font color="4444FF"><strong>}</strong></font>
            <font color="4444FF"><strong>}</strong></font>
        <font color="4444FF"><strong>}</strong></font>
    <font color="4444FF"><strong>}</strong></font> <strong>while</strong> <font color="4444FF">(</font><font color="4444FF">!</font><font color="#2040a0">ret</font><font color="4444FF">)</font><font color="4444FF">;</font>         <font color="#444444">/* Stop only on an error.  An error will occur
                               when we go exhaust the list of interfaces to
                               be examined */</font>
    <font color="#2040a0">getch</font><font color="4444FF">(</font><font color="4444FF">)</font><font color="4444FF">;</font>

    <font color="#444444">/* Free the bindings */</font>
    <font color="#2040a0">SNMP_FreeVarBind</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="#2040a0">SNMP_FreeVarBind</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">varBind</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF">;</font>
<font color="4444FF"><strong>}</strong></font>


</pre>


	


<hr class="noshade">

<h4 class=lmargin><a href="src/snmpapi.cpp">snmpapi.cpp</a></h4>

<pre>
<font color="#444444">/******************************************************************
*
*      Copyright (C) Stas Khirman 1998.  All rights reserved.         
*                                                                     
*       This program is distributed WITHOUT ANY WARRANTY
*
*******************************************************************/</font>

<font color="#444444">/*************************************************
*     
*       Reproduction of SNMP.LIB and SNMPAPI.LIB base
*           functions
*
* Author: Stas Khirman (staskh@rocketmail.com)
*
*
* Free software: no warranty; use anywhere is ok; spread the      
* sources; note any modifications; share variations and           
* derivatives (including sending to staskh@rocketmail.com).       
*                                                                     
*
*************************************************/</font>
<font color="0000ff"><strong>#include <font color="#008000">&lt;snmp.h&gt;</font></strong></font>

<font color="#2040a0">SNMPAPI</font>
<font color="#2040a0">SNMP_FUNC_TYPE</font>
<font color="#2040a0">SnmpUtilOidCpy</font><font color="4444FF">(</font>
    <font color="#2040a0">OUT</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font><font color="#2040a0">DstObjId</font>,
    <font color="#2040a0">IN</font>  <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font><font color="#2040a0">SrcObjId</font>
    <font color="4444FF">)</font>
<font color="4444FF"><strong>{</strong></font>
  <font color="#2040a0">DstObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font> <font color="4444FF">=</font> <font color="4444FF">(</font><font color="#2040a0">UINT</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">GlobalAlloc</font><font color="4444FF">(</font><font color="#2040a0">GMEM_ZEROINIT</font>,<font color="#2040a0">SrcObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font> <font color="4444FF">*</font> 
          <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">UINT</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>
  <strong>if</strong><font color="4444FF">(</font><font color="4444FF">!</font><font color="#2040a0">DstObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
    <font color="#2040a0">SetLastError</font><font color="4444FF">(</font><font color="#FF0000">1</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <strong>return</strong> <font color="#FF0000">0</font><font color="4444FF">;</font>
  <font color="4444FF"><strong>}</strong></font>

  <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">DstObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font>,<font color="#2040a0">SrcObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font>,<font color="#2040a0">SrcObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font><font color="4444FF">*</font><strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">UINT</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>
  <font color="#2040a0">DstObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font> <font color="4444FF">=</font> <font color="#2040a0">SrcObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font><font color="4444FF">;</font>

  <strong>return</strong> <font color="#FF0000">1</font><font color="4444FF">;</font>
<font color="4444FF"><strong>}</strong></font>


<font color="#2040a0">VOID</font>
<font color="#2040a0">SNMP_FUNC_TYPE</font>
<font color="#2040a0">SnmpUtilOidFree</font><font color="4444FF">(</font>
    <font color="#2040a0">IN</font> <font color="#2040a0">OUT</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font><font color="#2040a0">ObjId</font>
    <font color="4444FF">)</font>
<font color="4444FF"><strong>{</strong></font>
  <font color="#2040a0">GlobalFree</font><font color="4444FF">(</font><font color="#2040a0">ObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font><font color="4444FF">)</font><font color="4444FF">;</font>
  <font color="#2040a0">ObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
  <font color="#2040a0">ObjId</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
<font color="4444FF"><strong>}</strong></font>

<font color="#2040a0">SNMPAPI</font>
<font color="#2040a0">SNMP_FUNC_TYPE</font>
<font color="#2040a0">SnmpUtilOidNCmp</font><font color="4444FF">(</font>
    <font color="#2040a0">IN</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font><font color="#2040a0">ObjIdA</font>,
    <font color="#2040a0">IN</font> <font color="#2040a0">AsnObjectIdentifier</font> <font color="4444FF">*</font><font color="#2040a0">ObjIdB</font>,
    <font color="#2040a0">IN</font> <font color="#2040a0">UINT</font>                 <font color="#2040a0">Len</font>
    <font color="4444FF">)</font>
<font color="4444FF"><strong>{</strong></font>
  <font color="#2040a0">UINT</font> <font color="#2040a0">CmpLen</font><font color="4444FF">;</font>
  <font color="#2040a0">UINT</font> <font color="#2040a0">i</font><font color="4444FF">;</font>
  <strong>int</strong>  <font color="#2040a0">res</font><font color="4444FF">;</font>

  <font color="#2040a0">CmpLen</font> <font color="4444FF">=</font> <font color="#2040a0">Len</font><font color="4444FF">;</font>
  <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">ObjIdA</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font> <font color="4444FF">&lt;</font> <font color="#2040a0">CmpLen</font><font color="4444FF">)</font>
    <font color="#2040a0">CmpLen</font> <font color="4444FF">=</font> <font color="#2040a0">ObjIdA</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font><font color="4444FF">;</font>
  <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">ObjIdB</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font> <font color="4444FF">&lt;</font> <font color="#2040a0">CmpLen</font><font color="4444FF">)</font>
    <font color="#2040a0">CmpLen</font> <font color="4444FF">=</font> <font color="#2040a0">ObjIdB</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">idLength</font><font color="4444FF">;</font>

  <strong>for</strong><font color="4444FF">(</font><font color="#2040a0">i</font><font color="4444FF">=</font><font color="#FF0000">0</font><font color="4444FF">;</font><font color="#2040a0">i</font><font color="4444FF">&lt;</font><font color="#2040a0">CmpLen</font><font color="4444FF">;</font><font color="#2040a0">i</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
    <font color="#2040a0">res</font> <font color="4444FF">=</font> <font color="#2040a0">ObjIdA</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font><font color="4444FF">[</font><font color="#2040a0">i</font><font color="4444FF">]</font> <font color="4444FF">-</font> <font color="#2040a0">ObjIdB</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">ids</font><font color="4444FF">[</font><font color="#2040a0">i</font><font color="4444FF">]</font><font color="4444FF">;</font>
    <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">res</font><font color="4444FF">!</font><font color="4444FF">=</font><font color="#FF0000">0</font><font color="4444FF">)</font>
      <strong>return</strong> <font color="#2040a0">res</font><font color="4444FF">;</font>
  <font color="4444FF"><strong>}</strong></font>
  <strong>return</strong> <font color="#FF0000">0</font><font color="4444FF">;</font>
<font color="4444FF"><strong>}</strong></font>

<font color="#2040a0">VOID</font>
<font color="#2040a0">SNMP_FUNC_TYPE</font>
<font color="#2040a0">SnmpUtilVarBindFree</font><font color="4444FF">(</font>
    <font color="#2040a0">IN</font> <font color="#2040a0">OUT</font> <font color="#2040a0">RFC1157VarBind</font> <font color="4444FF">*</font><font color="#2040a0">VarBind</font>
    <font color="4444FF">)</font>
<font color="4444FF"><strong>{</strong></font>
  <font color="#2040a0">BYTE</font> <font color="#2040a0">asnType</font><font color="4444FF">;</font>
  <font color="#444444">// free object name</font>
  <font color="#2040a0">SnmpUtilOidFree</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">name</font><font color="4444FF">)</font><font color="4444FF">;</font>

  <font color="#2040a0">asnType</font> <font color="4444FF">=</font> <font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">value</font>.<font color="#2040a0">asnType</font><font color="4444FF">;</font>

  <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">asnType</font><font color="4444FF">=</font><font color="4444FF">=</font><font color="#2040a0">ASN_OBJECTIDENTIFIER</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
    <font color="#2040a0">SnmpUtilOidFree</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">object</font><font color="4444FF">)</font><font color="4444FF">;</font>
  <font color="4444FF"><strong>}</strong></font>
  <strong>else</strong> <strong>if</strong><font color="4444FF">(</font>
        <font color="4444FF">(</font><font color="#2040a0">asnType</font><font color="4444FF">=</font><font color="4444FF">=</font><font color="#2040a0">ASN_OCTETSTRING</font><font color="4444FF">)</font> <font color="4444FF">|</font><font color="4444FF">|</font>
        <font color="4444FF">(</font><font color="#2040a0">asnType</font><font color="4444FF">=</font><font color="4444FF">=</font><font color="#2040a0">ASN_RFC1155_IPADDRESS</font><font color="4444FF">)</font> <font color="4444FF">|</font><font color="4444FF">|</font>
        <font color="4444FF">(</font><font color="#2040a0">asnType</font><font color="4444FF">=</font><font color="4444FF">=</font><font color="#2040a0">ASN_RFC1155_OPAQUE</font><font color="4444FF">)</font> <font color="4444FF">|</font><font color="4444FF">|</font>
        <font color="4444FF">(</font><font color="#2040a0">asnType</font><font color="4444FF">=</font><font color="4444FF">=</font><font color="#2040a0">ASN_SEQUENCE</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
    <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">string</font>.<font color="#2040a0">dynamic</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
      <font color="#2040a0">GlobalFree</font><font color="4444FF">(</font><font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">value</font>.<font color="#2040a0">asnValue</font>.<font color="#2040a0">string</font>.<font color="#2040a0">stream</font><font color="4444FF">)</font><font color="4444FF">;</font>
    <font color="4444FF"><strong>}</strong></font>
  <font color="4444FF"><strong>}</strong></font>

  <font color="#2040a0">VarBind</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">value</font>.<font color="#2040a0">asnType</font> <font color="4444FF">=</font> <font color="#2040a0">ASN_NULL</font><font color="4444FF">;</font>

<font color="4444FF"><strong>}</strong></font>


</pre>



		</div> <!-- end body div -->

<hr class="noshade">


<!--  Navigation footer  -->
<table class="fullwidth" cellpadding="5" cellspacing="0" summary="footer nav"> 
	<tr>
		<td align="left" class="halfwidth">
		
			
			
			
			<span class="large">
				<a href="../examples/getmac-rpc.html">&lt;&lt;&nbsp;Get MAC Address, RPC Method</a><br>
			</span>
		
		</td>

		<td align="right" class="halfwidth">
		
			
			
			
			<span class="large">
				<a href="../examples/username.html">Get the Username&nbsp;&gt;&gt;</a>
			</span>
		
		</td>
	</tr>
</table>






	<!--  Document Footer -->

	<table class="fullwidth" cellpadding="5" cellspacing="0" summary="footer info"> 
		<tr>
			
				<td align="left" class="thirdwidth">
					
					<span class="annotation">Updated Wed Oct 28 2009 04:49 MDT</span>
				</td>
				<td align="center" class="thirdwidth">
				
			

			
				&nbsp;
			
			</td>

			<td align="right" class="thirdwidth">
				<a href="/">Go to my home page</a>
			</td>
		</tr>	
	</table>


	<script type="text/javascript" src="/js/awstats_misc_tracker.js"></script>
</body>
</html>

